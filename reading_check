<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë“€ì–¼ ë¸Œë ˆì¸ ë…ì„œ ì§„ë„ ê´€ë¦¬</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .light-mode {
            background-color: #f9fafb;
            color: #1f2937;
        }

        .dark-mode {
            background-color: #111827;
            color: #ffffff;
        }

        .container {
            max-width: 1024px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .header {
            position: sticky;
            top: 0;
            z-index: 10;
            border-bottom: 1px solid;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .light-mode .header {
            background-color: #ffffff;
            border-color: #e5e7eb;
        }

        .dark-mode .header {
            background-color: #1f2937;
            border-color: #374151;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .header-title h1 {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .header-subtitle {
            font-size: 0.875rem;
            opacity: 0.7;
            margin-top: 0.25rem;
        }

        .header-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.5rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .light-mode .btn {
            background-color: #f3f4f6;
            color: #1f2937;
        }

        .light-mode .btn:hover {
            background-color: #e5e7eb;
        }

        .dark-mode .btn {
            background-color: #374151;
            color: #ffffff;
        }

        .dark-mode .btn:hover {
            background-color: #4b5563;
        }

        .main-content {
            padding: 1.5rem 0;
        }

        .section {
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            border-radius: 0.75rem;
            border: 1px solid;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .light-mode .section {
            background-color: #ffffff;
            border-color: #e5e7eb;
        }

        .dark-mode .section {
            background-color: #1f2937;
            border-color: #374151;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            padding: 1rem;
            border-radius: 0.75rem;
            border: 1px solid;
        }

        .light-mode .stat-card {
            background-color: #ffffff;
            border-color: #e5e7eb;
        }

        .dark-mode .stat-card {
            background-color: #1f2937;
            border-color: #374151;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.875rem;
            opacity: 0.7;
        }

        .progress-bar-container {
            width: 100%;
            height: 1rem;
            border-radius: 9999px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .light-mode .progress-bar-container {
            background-color: #e5e7eb;
        }

        .dark-mode .progress-bar-container {
            background-color: #374151;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            transition: width 0.5s ease-out;
        }

        .badges-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .badge {
            padding: 1rem;
            border-radius: 0.5rem;
            border: 2px solid;
            text-align: center;
            transition: all 0.3s ease;
        }

        .badge.earned {
            border-color: #facc15;
        }

        .light-mode .badge.earned {
            background-color: #fefce8;
        }

        .dark-mode .badge.earned {
            background-color: rgba(251, 191, 36, 0.2);
        }

        .light-mode .badge:not(.earned) {
            background-color: #f9fafb;
            border-color: #e5e7eb;
        }

        .dark-mode .badge:not(.earned) {
            background-color: rgba(55, 65, 81, 0.5);
            border-color: #4b5563;
        }

        .badge-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .badge:not(.earned) .badge-icon {
            filter: grayscale(100%);
            opacity: 0.5;
        }

        .badge-name {
            font-size: 0.875rem;
            font-weight: 500;
        }

        .badge-description {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 0.25rem;
        }

        .week-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .week-01 {
            color: #2563eb;
        }

        .week-02 {
            color: #7c3aed;
        }

        .day-item {
            margin-bottom: 1rem;
        }

        .day-content {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-radius: 0.5rem;
            border: 1px solid;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .light-mode .day-content:not(.completed) {
            border-color: #e5e7eb;
        }

        .light-mode .day-content:not(.completed):hover {
            background-color: #f9fafb;
        }

        .light-mode .day-content.completed {
            background-color: #f0fdf4;
            border-color: #22c55e;
        }

        .dark-mode .day-content:not(.completed) {
            border-color: #4b5563;
        }

        .dark-mode .day-content:not(.completed):hover {
            background-color: #374151;
        }

        .dark-mode .day-content.completed {
            background-color: rgba(34, 197, 94, 0.2);
            border-color: #22c55e;
        }

        .day-content.weekend {
            border-left: 4px solid #f59e0b;
        }

        .day-content.week-01:not(.weekend) {
            border-left: 4px solid #3b82f6;
        }

        .day-content.week-02:not(.weekend) {
            border-left: 4px solid #8b5cf6;
        }

        .day-checkbox {
            width: 1.75rem;
            height: 1.75rem;
            border: 2px solid #9ca3af;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .day-checkbox.checked {
            background-color: #22c55e;
            border-color: #22c55e;
            color: white;
        }

        .day-checkbox:hover {
            transform: scale(1.1);
        }

        .day-info {
            flex-grow: 1;
        }

        .day-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .day-title.completed {
            text-decoration: line-through;
            opacity: 0.7;
        }

        .day-title.weekend {
            color: #ea580c;
        }

        .day-title.week-01:not(.weekend) {
            color: #2563eb;
        }

        .day-title.week-02:not(.weekend) {
            color: #7c3aed;
        }

        .dark-mode .day-title.weekend {
            color: #fb923c;
        }

        .dark-mode .day-title.week-01:not(.weekend) {
            color: #60a5fa;
        }

        .dark-mode .day-title.week-02:not(.weekend) {
            color: #a78bfa;
        }

        .day-pages {
            font-size: 0.875rem;
            opacity: 0.7;
        }

        .day-completed {
            font-size: 0.75rem;
            color: #22c55e;
            font-weight: 500;
            margin-top: 0.25rem;
        }

        .note-btn {
            padding: 0.5rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            opacity: 0;
            transition: all 0.2s ease;
            background: none;
        }

        .day-item:hover .note-btn {
            opacity: 1;
        }

        .note-btn.has-note {
            color: #3b82f6;
        }

        .note-btn:not(.has-note) {
            color: #9ca3af;
        }

        .note-content {
            margin-top: 0.5rem;
            margin-left: 2.75rem;
            padding: 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
        }

        .light-mode .note-content {
            background-color: #f3f4f6;
        }

        .dark-mode .note-content {
            background-color: #374151;
        }

        .note-edit {
            margin-top: 0.5rem;
            margin-left: 2.75rem;
        }

        .note-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid;
            border-radius: 0.5rem;
            resize: none;
            font-family: inherit;
        }

        .light-mode .note-textarea {
            background-color: #ffffff;
            border-color: #d1d5db;
            color: #1f2937;
        }

        .dark-mode .note-textarea {
            background-color: #374151;
            border-color: #4b5563;
            color: #ffffff;
        }

        .note-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .btn-primary {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            background-color: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background-color: #2563eb;
        }

        .btn-secondary {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .light-mode .btn-secondary {
            background-color: #e5e7eb;
            color: #1f2937;
        }

        .light-mode .btn-secondary:hover {
            background-color: #d1d5db;
        }

        .dark-mode .btn-secondary {
            background-color: #374151;
            color: #ffffff;
        }

        .dark-mode .btn-secondary:hover {
            background-color: #4b5563;
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(90deg, #8b5cf6, #ec4899);
            color: white;
            padding: 2rem;
            border-radius: 9999px;
            font-size: 1.25rem;
            font-weight: bold;
            z-index: 1000;
            animation: bounce 1s infinite;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: translate(-50%, -50%) translateY(0);
            }
            40%, 43% {
                transform: translate(-50%, -50%) translateY(-30px);
            }
            70% {
                transform: translate(-50%, -50%) translateY(-15px);
            }
            90% {
                transform: translate(-50%, -50%) translateY(-4px);
            }
        }

        .footer-message {
            text-align: center;
            padding: 1rem;
            font-size: 0.875rem;
            opacity: 0.7;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .badges-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .day-content {
                gap: 0.75rem;
                padding: 0.75rem;
            }
            
            .day-title {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body class="light-mode">
    <!-- Header -->
    <div class="header">
        <div class="container">
            <div class="header-content">
                <div class="header-title">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                    </svg>
                    <div>
                        <h1>ë“€ì–¼ ë¸Œë ˆì¸ ë…ì„œ ì§„ë„</h1>
                        <div class="header-subtitle">ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
                    </div>
                </div>
                <div class="header-buttons">
                    <button class="btn" onclick="toggleDarkMode()">
                        <svg id="theme-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="5"/>
                            <line x1="12" y1="1" x2="12" y2="3"/>
                            <line x1="12" y1="21" x2="12" y2="23"/>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                            <line x1="1" y1="12" x2="3" y2="12"/>
                            <line x1="21" y1="12" x2="23" y2="12"/>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                        </svg>
                    </button>
                    <button class="btn" onclick="resetProgress()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                            <path d="M3 3v5h5"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Celebration Animation -->
    <div id="celebration" class="celebration" style="display: none;"></div>

    <div class="container">
        <div class="main-content">
            <!-- Stats Overview -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" style="color: #3b82f6;" id="progress-percentage">0%</div>
                    <div class="stat-label">ì „ì²´ ì§„ë„ìœ¨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" style="color: #22c55e;" id="completed-days">0</div>
                    <div class="stat-label">ì™„ë£Œ ë‹¨ê³„</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" style="color: #f59e0b;" id="streak-count">0</div>
                    <div class="stat-label">ì—°ì† í•™ìŠµì¼</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" style="color: #8b5cf6;" id="badge-count">0</div>
                    <div class="stat-label">íšë“ ë°°ì§€</div>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="section">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                    <h2 style="font-size: 1.125rem; font-weight: 600;">ì „ì²´ ì§„ë„</h2>
                    <span style="font-size: 0.875rem; opacity: 0.7;" id="progress-text">0/12 ì™„ë£Œ</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progress-bar" style="width: 0%;"></div>
                </div>
                <div style="text-align: center; margin-top: 0.75rem;">
                    <p style="font-size: 0.875rem; font-weight: 500;" id="motivation-message">ë“€ì–¼ ë¸Œë ˆì¸ ë…ì„œ ì—¬í–‰ì„ ì‹œì‘í•´ë³´ì„¸ìš”! ğŸš€</p>
                </div>
            </div>

            <!-- Badges -->
            <div class="section">
                <h2 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 1rem;">ì„±ì·¨ ë°°ì§€</h2>
                <div class="badges-grid">
                    <div class="badge" id="badge-fire">
                        <div class="badge-icon">ğŸ”¥</div>
                        <div class="badge-name">ë¶ˆíƒ€ëŠ” ì—´ì •</div>
                        <div class="badge-description">3ì¼ ì—°ì† í•™ìŠµ</div>
                    </div>
                    <div class="badge" id="badge-lightning">
                        <div class="badge-icon">âš¡</div>
                        <div class="badge-name">ë²ˆê°œ ê°™ì€ ì§‘ì¤‘ë ¥</div>
                        <div class="badge-description">7ì¼ ì—°ì† í•™ìŠµ</div>
                    </div>
                    <div class="badge" id="badge-trophy">
                        <div class="badge-icon">ğŸ†</div>
                        <div class="badge-name">ì±”í”¼ì–¸</div>
                        <div class="badge-description">14ì¼ ì—°ì† í•™ìŠµ</div>
                    </div>
                    <div class="badge" id="badge-diamond">
                        <div class="badge-icon">ğŸ’</div>
                        <div class="badge-name">ë‹¤ì´ì•„ëª¬ë“œ í•™ìŠµì</div>
                        <div class="badge-description">30ì¼ ì—°ì† í•™ìŠµ</div>
                    </div>
                </div>
            </div>

            <!-- Expected Completion -->
            <div class="section">
                <h2 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M16 8l-8 8"/>
                        <path d="M8 8l8 8"/>
                    </svg>
                    ì˜ˆìƒ ì™„ë£Œì¼
                </h2>
                <p style="font-size: 2rem; font-weight: bold; color: #22c55e;" id="expected-completion">ì²« ë²ˆì§¸ Dayë¥¼ ì‹œì‘í•˜ë©´ ì˜ˆìƒ ì™„ë£Œì¼ì„ ê³„ì‚°í•´ë“œë ¤ìš”</p>
            </div>

            <!-- Week 1 -->
            <div class="section">
                <div class="week-title week-01">
                    WEEK 01
                    <span style="font-size: 0.875rem; opacity: 0.7;" id="week1-progress">0/6 ì™„ë£Œ</span>
                </div>
                <div id="week1-days"></div>
            </div>

            <!-- Week 2 -->
            <div class="section">
                <div class="week-title week-02">
                    WEEK 02
                    <span style="font-size: 0.875rem; opacity: 0.7;" id="week2-progress">0/6 ì™„ë£Œ</span>
                </div>
                <div id="week2-days"></div>
            </div>

            <!-- Footer Message -->
            <div class="section">
                <div class="footer-message">
                    ë…ì„œ ì§„ë„í‘œëŠ” ê¾¸ì¤€í•œ ë…ì„œë¥¼ ìœ„í•œ ì°¸ê³ ìš©ì´ë©°, ê°ìì˜ ì†ë„ì— ë§ì¶°ì„œ í™œìš©í•´ì£¼ì„¸ìš”! ğŸŒŸ
                </div>
            </div>
        </div>
    </div>

    <script>
        // í•™ìŠµ ë°ì´í„°
        const studyData = {
            days: [
                {
                    id: 1,
                    title: 'DAY 01 - ë“¤ì–´ê°€ëŠ” ë§',
                    pages: '8-19p',
                    week: 1,
                    type: 'day',
                    completed: false,
                    completedDate: null
                },
                {
                    id: 2,
                    title: 'DAY 02 - 1ë¶€ 1ì¥',
                    pages: '22-51p',
                    week: 1,
                    type: 'day',
                    completed: false,
                    completedDate: null
                },
                {
                    id: 3,
                    title: 'DAY 03 - 1ë¶€ 2ì¥',
                    pages: '52-74p',
                    week: 1,
                    type: 'day',
                    completed: false,
                    completedDate: null
                },
                {
                    id: 4,
                    title: 'DAY 04 - 1ë¶€ 3ì¥',
                    pages: '75-96p',
                    week: 1,
                    type: 'day',
                    completed: false,
                    completedDate: null
                },
                {
                    id: 5,
                    title: 'DAY 05 - 2ë¶€ 4ì¥',
                    pages: '98-133p',
                    week: 1,
                    type: 'day',
                    completed: false,
                    completedDate: null
                },
                {
                    id: 6,
                    title: 'ì£¼ë§ - ë°‘ì¤„ ì§„ë„ ì¬ìš°ê¸° & 1íšŒ OTì˜ìƒ ì‹œì²­',
                    pages: '8-133p ë³µìŠµ',
                    week: 1,
                    type: 'weekend',
                    completed: false,
                    completedDate: null
                },
                {
                    id: 7,
                    title: 'DAY 06 - 2ë¶€ 5ì¥',
                    pages: '134-173p',
                    week: 2,
                    type: 'day',
                    completed: false,
                    completedDate: null
                },
                {
                    id: 8,
                    title: 'DAY 07 - 2ë¶€ 6ì¥',
                    pages: '174-218p',
                    week: 2,
                    type: 'day',
                    completed: false,
                    completedDate: null
                },
                {
                    id: 9,
                    title: 'DAY 08 - 2ë¶€ 7ì¥',
                    pages: '219-242p',
                    week: 2,
                    type: 'day',
                    completed: false,
                    completedDate: null
                },
                {
                    id: 10,
                    title: 'DAY 09 - 2ë¶€ 8ì¥',
                    pages: '243-259p',
                    week: 2,
                    type: 'day',
                    completed: false,
                    completedDate: null
                },
                {
                    id: 11,
                    title: 'DAY 10 - 2ë¶€ 9ì¥ (ê°ì‚¬ì˜ ë§)',
                    pages: '260-286p',
                    week: 2,
                    type: 'day',
                    completed: false,
                    completedDate: null
                },
                {
                    id: 12,
                    title: 'ì£¼ë§ - ë°‘ì¤„ ì§„ë„ ì¬ìš°ê¸° & ì½í ì¸ì‚¬ì´ë“œ ì˜ìƒ ì‹œì²­ & ì„œí‰ì“°ê¸°',
                    pages: '134-286p ë³µìŠµ',
                    week: 2,
                    type: 'weekend',
                    completed: false,
                    completedDate: null
                }
            ],
            streakCount: 0,
            lastStudyDate: null,
            badges: [],
            notes: {}
        };

        const badges = [
            { id: 'fire', name: 'ë¶ˆíƒ€ëŠ” ì—´ì •', requirement: 3 },
            { id: 'lightning', name: 'ë²ˆê°œ ê°™ì€ ì§‘ì¤‘ë ¥', requirement: 7 },
            { id: 'trophy', name: 'ì±”í”¼ì–¸', requirement: 14 },
            { id: 'diamond', name: 'ë‹¤ì´ì•„ëª¬ë“œ í•™ìŠµì', requirement: 30 }
        ];

        let editingNote = null;

        // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¡œë“œ
        function loadData() {
            const saved = localStorage.getItem('dualBrainStudyData');
            if (saved) {
                const savedData = JSON.parse(saved);
                Object.assign(studyData, savedData);
            }
        }

        // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„° ì €ì¥
        function saveData() {
            localStorage.setItem('dualBrainStudyData', JSON.stringify(studyData));
        }

        // ë‹¤í¬ëª¨ë“œ í† ê¸€
        function toggleDarkMode() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            
            if (body.classList.contains('light-mode')) {
                body.classList.remove('light-mode');
                body.classList.add('dark-mode');
                themeIcon.innerHTML = `
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                `;
                localStorage.setItem('darkMode', 'true');
            } else {
                body.classList.remove('dark-mode');
                body.classList.add('light-mode');
                themeIcon.innerHTML = `
                    <circle cx="12" cy="12" r="5"/>
                    <line x1="12" y1="1" x2="12" y2="3"/>
                    <line x1="12" y1="21" x2="12" y2="23"/>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                    <line x1="1" y1="12" x2="3" y2="12"/>
                    <line x1="21" y1="12" x2="23" y2="12"/>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                `;
                localStorage.setItem('darkMode', 'false');
            }
        }

        // ì§„ë„ ì´ˆê¸°í™”
        function resetProgress() {
            if (confirm('ëª¨ë“  ì§„ë„ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                studyData.days.forEach(day => {
                    day.completed = false;
                    day.completedDate = null;
                });
                studyData.streakCount = 0;
                studyData.lastStudyDate = null;
                studyData.badges = [];
                studyData.notes = {};
                saveData();
                updateUI();
            }
        }

        // ì—°ì† í•™ìŠµì¼ ê³„ì‚°
        function checkStreak(newDate) {
            const today = new Date(newDate);
            const lastDate = studyData.lastStudyDate ? new Date(studyData.lastStudyDate) : null;
            
            if (!lastDate) {
                return 1;
            }
            
            const diffTime = today.getTime() - lastDate.getTime();
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 1) {
                return studyData.streakCount + 1;
            } else if (diffDays === 0) {
                return studyData.streakCount;
            } else {
                return 1;
            }
        }

        // ë°°ì§€ ì—…ë°ì´íŠ¸
        function updateBadges(newStreak) {
            const newBadges = [...studyData.badges];
            badges.forEach(badge => {
                if (newStreak >= badge.requirement && !newBadges.includes(badge.id)) {
                    newBadges.push(badge.id);
                    showCelebration(`ğŸ‰ ìƒˆë¡œìš´ ë°°ì§€ íšë“: ${badge.name}!`);
                }
            });
            return newBadges;
        }

        // ì¶•í•˜ ì• ë‹ˆë©”ì´ì…˜ í‘œì‹œ
        function showCelebration(message) {
            const celebration = document.getElementById('celebration');
            celebration.textContent = message;
            celebration.style.display = 'block';
            setTimeout(() => {
                celebration.style.display = 'none';
            }, 3000);
        }

        // Day ì™„ë£Œ/ì·¨ì†Œ í† ê¸€
        function toggleDay(dayId) {
            const today = new Date().toISOString().split('T')[0];
            const day = studyData.days.find(d => d.id === dayId);
            
            day.completed = !day.completed;
            day.completedDate = day.completed ? today : null;
            
            if (day.completed) {
                const newStreak = checkStreak(today);
                studyData.streakCount = newStreak;
                studyData.lastStudyDate = today;
                studyData.badges = updateBadges(newStreak);
                
                // ì™„ë£Œ ì¶•í•˜ ë©”ì‹œì§€
                if (day.type === 'weekend') {
                    showCelebration(`ğŸ‰ ${day.title.includes('1íšŒ') ? '1ì£¼ì°¨' : '2ì£¼ì°¨'} ì™„ì£¼! ëŒ€ë‹¨í•´ìš”!`);
                } else {
                    showCelebration(`âœ… ${day.title} ì™„ë£Œ! ì˜í•˜ê³  ìˆì–´ìš”!`);
                }
            }
            
            saveData();
            updateUI();
        }

        // ì§„ë„ ê³„ì‚°
        function calculateProgress() {
            const totalDays = studyData.days.length;
            const completedDays = studyData.days.filter(day => day.completed).length;
            
            return {
                percentage: totalDays > 0 ? Math.round((completedDays / totalDays) * 100) : 0,
                completedDays,
                totalDays
            };
        }

        // ë™ê¸°ë¶€ì—¬ ë©”ì‹œì§€
        function getMotivationMessage(percentage) {
            if (percentage === 0) return "ë“€ì–¼ ë¸Œë ˆì¸ ë…ì„œ ì—¬í–‰ì„ ì‹œì‘í•´ë³´ì„¸ìš”! ğŸš€";
            if (percentage < 25) return "ì¢‹ì€ ì‹œì‘ì´ì—ìš”! ë…ì„œì˜ ì¦ê±°ì›€ì„ ëŠê»´ë³´ì„¸ìš” ğŸ“š";
            if (percentage < 50) return "ì ˆë°˜ê¹Œì§€ ì™”ì–´ìš”! ë‡Œê°€ ë³€í™”í•˜ê³  ìˆì–´ìš” ğŸ§ ";
            if (percentage < 75) return "3/4 ì§€ì  í†µê³¼! ë“€ì–¼ ë¸Œë ˆì¸ì´ í™œì„±í™”ë˜ê³  ìˆì–´ìš” âš¡";
            if (percentage < 100) return "ë§ˆì§€ë§‰ ìŠ¤í¼íŠ¸! ì™„ì£¼ê¹Œì§€ ì–¼ë§ˆ ì•ˆ ë‚¨ì•˜ì–´ìš” ğŸƒâ€â™‚ï¸";
            return "ë“€ì–¼ ë¸Œë ˆì¸ ë…ì„œ ì™„ì£¼ ì¶•í•˜ë“œë ¤ìš”! ğŸ‰ğŸ† ë‹¹ì‹ ì˜ ë‡ŒëŠ” ì´ì œ ì™„ì „íˆ ë‹¤ë¦…ë‹ˆë‹¤!";
        }

        // ì˜ˆìƒ ì™„ë£Œì¼ ê³„ì‚°
        function calculateExpectedCompletion() {
            const progress = calculateProgress();
            if (progress.completedDays === 0) return "ì²« ë²ˆì§¸ Dayë¥¼ ì‹œì‘í•˜ë©´ ì˜ˆìƒ ì™„ë£Œì¼ì„ ê³„ì‚°í•´ë“œë ¤ìš”";
            
            const completedDates = studyData.days
                .filter(day => day.completed && day.completedDate)
                .map(day => new Date(day.completedDate))
                .sort((a, b) => a - b);
            
            if (completedDates.length < 2) return "ë” ë§ì€ í•™ìŠµ ë°ì´í„°ê°€ í•„ìš”í•´ìš”";
            
            const firstDate = completedDates[0];
            const lastDate = completedDates[completedDates.length - 1];
            const daysElapsed = Math.ceil((lastDate - firstDate) / (1000 * 60 * 60 * 24)) + 1;
            const avgDaysPerDay = progress.completedDays / daysElapsed;
            const remainingDays = progress.totalDays - progress.completedDays;
            const daysToComplete = Math.ceil(remainingDays / avgDaysPerDay);
            
            const expectedDate = new Date();
            expectedDate.setDate(expectedDate.getDate() + daysToComplete);
            
            return `${expectedDate.toLocaleDateString('ko-KR')} (ì•½ ${daysToComplete}ì¼ í›„)`;
        }

        // ë…¸íŠ¸ í¸ì§‘ ì‹œì‘
        function startEditNote(dayId) {
            editingNote = dayId;
            renderDays();
        }

        // ë…¸íŠ¸ ì €ì¥
        function saveNote(dayId) {
            const textarea = document.getElementById(`note-textarea-${dayId}`);
            studyData.notes[dayId] = textarea.value;
            editingNote = null;
            saveData();
            renderDays();
        }

        // ë…¸íŠ¸ í¸ì§‘ ì·¨ì†Œ
        function cancelEditNote() {
            editingNote = null;
            renderDays();
        }

        // Day í•­ëª© ë Œë”ë§
        function renderDay(day) {
            const hasNote = studyData.notes[day.id];
            const isEditing = editingNote === day.id;
            
            return `
                <div class="day-item">
                    <div class="day-content ${day.completed ? 'completed' : ''} ${day.type} week-${day.week < 10 ? '0' + day.week : day.week}">
                        <div class="day-checkbox ${day.completed ? 'checked' : ''}" onclick="toggleDay(${day.id})">
                            ${day.completed ? 'âœ“' : ''}
                        </div>
                        <div class="day-info">
                            <div class="day-title ${day.completed ? 'completed' : ''} ${day.type} week-${day.week < 10 ? '0' + day.week : day.week}">
                                ${day.title}
                            </div>
                            <div class="day-pages">${day.pages}</div>
                            ${day.completedDate ? `
                                <div class="day-completed">
                                    âœ… ì™„ë£Œì¼: ${new Date(day.completedDate).toLocaleDateString('ko-KR')}
                                </div>
                            ` : ''}
                        </div>
                        <button class="note-btn ${hasNote ? 'has-note' : ''}" onclick="startEditNote(${day.id})">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                            </svg>
                        </button>
                    </div>
                    ${hasNote && !isEditing ? `
                        <div class="note-content">${studyData.notes[day.id]}</div>
                    ` : ''}
                    ${isEditing ? `
                        <div class="note-edit">
                            <textarea id="note-textarea-${day.id}" class="note-textarea" rows="3" placeholder="í•™ìŠµ ë…¸íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...">${studyData.notes[day.id] || ''}</textarea>
                            <div class="note-buttons">
                                <button class="btn-primary" onclick="saveNote(${day.id})">ì €ì¥</button>
                                <button class="btn-secondary" onclick="cancelEditNote()">ì·¨ì†Œ</button>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // ì£¼ë³„ Dayë“¤ ë Œë”ë§
        function renderDays() {
            const week1Days = studyData.days.filter(day => day.week === 1);
            const week2Days = studyData.days.filter(day => day.week === 2);
            
            document.getElementById('week1-days').innerHTML = week1Days.map(renderDay).join('');
            document.getElementById('week2-days').innerHTML = week2Days.map(renderDay).join('');
            
            // ì£¼ë³„ ì§„ë„ ì—…ë°ì´íŠ¸
            const week1Completed = week1Days.filter(day => day.completed).length;
            const week2Completed = week2Days.filter(day => day.completed).length;
            
            document.getElementById('week1-progress').textContent = `${week1Completed}/${week1Days.length} ì™„ë£Œ`;
            document.getElementById('week2-progress').textContent = `${week2Completed}/${week2Days.length} ì™„ë£Œ`;
        }

        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            const progress = calculateProgress();
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            document.getElementById('progress-percentage').textContent = `${progress.percentage}%`;
            document.getElementById('completed-days').textContent = progress.completedDays;
            document.getElementById('streak-count').textContent = `${studyData.streakCount}ì¼`;
            document.getElementById('badge-count').textContent = studyData.badges.length;
            
            // ì§„í–‰ë°” ì—…ë°ì´íŠ¸
            document.getElementById('progress-bar').style.width = `${progress.percentage}%`;
            document.getElementById('progress-text').textContent = `${progress.completedDays}/${progress.totalDays} ì™„ë£Œ`;
            document.getElementById('motivation-message').textContent = getMotivationMessage(progress.percentage);
            
            // ë°°ì§€ ì—…ë°ì´íŠ¸
            badges.forEach(badge => {
                const badgeElement = document.getElementById(`badge-${badge.id}`);
                if (studyData.badges.includes(badge.id)) {
                    badgeElement.classList.add('earned');
                } else {
                    badgeElement.classList.remove('earned');
                }
            });
            
            // ì˜ˆìƒ ì™„ë£Œì¼ ì—…ë°ì´íŠ¸
            document.getElementById('expected-completion').textContent = calculateExpectedCompletion();
            
            // Dayë“¤ ë Œë”ë§
            renderDays();
        }

        // ì´ˆê¸°í™”
        function init() {
            // ë‹¤í¬ëª¨ë“œ ì„¤ì • ë¡œë“œ
            const savedDarkMode = localStorage.getItem('darkMode');
            if (savedDarkMode === 'true') {
                toggleDarkMode();
            }
            
            // ë°ì´í„° ë¡œë“œ ë° UI ì—…ë°ì´íŠ¸
            loadData();
            updateUI();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
